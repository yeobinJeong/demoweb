
		//1. 요청 정보에서 다운로드할 파일 이름 읽기 
		//   (목록페이지에서 선택된 파일 이름)
		//   파일 이름을 읽지 못하면 -> 목록으로 이동
		String file = req.getParameter("file");
		if (file == null || file.length() == 0) {
			resp.sendRedirect("07.filelist.jsp");
			return;
		}
		
		//2. 다운로드 처리
		//req.getServletContext() : jsp에서 사용한 application 객체 반환
		ServletContext application = req.getServletContext();
		String path = application.getRealPath("/jspdemo/files");
		
		//응답 컨텐츠의 종류를 지정
		//resp.setContentType("application/octet-stream");
		resp.setContentType("application/unknown");
		
		//다운로드되는 파일의 이름을 설정		
		//utf-8 형식의 문자열을 iso-8859-1 형식의 문자열로 변경
		String f2 = new String(file.getBytes("utf-8"), "ISO-8859-1");
		f2 = f2.replace("+", "%20");//위 처리는 공백을 +로 처리 -> +를 %20으로 변경
		
		resp.addHeader("Content-Disposition", 
			//"attachment;filename=" + URLEncoder.encode(file, "utf-8"));
			"attachment;filename=\"" + f2  + "\"");	
		
		//파일을 응답 컨텐츠로 기록
		File f = new File(path, file);//path와 file을 이어서 경로를 구성
		FileInputStream fis = new FileInputStream(f);		
		OutputStream os = resp.getOutputStream();		
		while(true) {
			int data = fis.read(); //파일에서 1byte 읽기			
			if(data == -1) break; //읽은 데이터가 없으면 중단			
			os.write(data);//응답에 1byte 쓰기
		}		
		fis.close();
		os.close();
			
